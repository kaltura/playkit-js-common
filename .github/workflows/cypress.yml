on:
  workflow_call:

jobs:
  chrome:
    runs-on: ubuntu-20.04
    name: E2E on Chrome
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Install dependencies
        uses: cypress-io/github-action@v5
        with:
          runTests: false
      - name: Build
        run: yarn run test:prepare
      - name: E2E on Chrome
        uses: cypress-io/github-action@v5
        with:
          install: false
          config: video=false
          browser: chrome
  firefox:
    runs-on: ubuntu-20.04
    name: E2E on Firefox
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Install dependencies
        uses: cypress-io/github-action@v5
        with:
          build: npx playwright install-deps webkit
          runTests: false
      - name: Build
        run: yarn run test:prepare
      - name: E2E on Firefox
        uses: cypress-io/github-action@v5
        with:
          install: false
          config: video=false
          browser: firefox
      - name: Upload screenshots
        uses: actions/upload-artifact@latest
        if: failure()
        with:
          name: cypress-snapshots
          path: cypress/snapshots
  edge:
    runs-on: ubuntu-20.04
    name: E2E on Edge
    steps:
      - name: Checkout
        uses: actions/checkout@v3
      - name: Install dependencies
        uses: cypress-io/github-action@v5
        with:
          runTests: false
      - name: Build
        run: yarn run test:prepare
      - name: E2E on Edge
        uses: cypress-io/github-action@v5
        with:
          install: false
          config: video=false
          browser: edge
  # safari:
  #   runs-on: ubuntu-20.04
  #   name: E2E on Firefox
  #   steps:
  #     - name: Checkout
  #       uses: actions/checkout@v3
  #     - name: Install dependencies
  #       uses: cypress-io/github-action@v5
  #       with:
  #         # install WebKit browser dependencies
  #         build: npx playwright install-deps webkit
  #         runTests: false
  #     - name: Build
  #       run: yarn run test:prepare
  #     - name: E2E on Safari
  #       uses: cypress-io/github-action@v5
  #       with:
  #         install: false
  #         config: video=false
  #         browser: webkit
